!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.LazyLoadImg=b()}(this,function(){"use strict";var a=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=a.getBoundingClientRect(),d=a.offsetWidth,e=a.offsetHeight,f=window.innerWidth,g=window.innerHeight,h=!(c.right-b.left<=0&&c.left+d-b.left<=0||c.left+b.right>=f&&c.right+b.right>=d+f),i=!(c.bottom-b.top<=0&&c.top+e-b.top<=0||c.top+b.bottom>=g&&c.bottom+b.bottom>=e+g);return 0!==a.width&&0!==a.height&&h&&i},b=document.createElement("canvas");b.getContext("2d").globalAlpha=0;var c={},d=function(a,d,e){if(c[a])return c[a];b.width=d,b.height=e;var f=b.toDataURL("image/png");return c[a]=f,f},e=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},h=window;return function(){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(this,b),this.options={el:document.querySelector("body"),mode:"default",time:300,done:!0,diy:{backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center center"},position:{top:0,right:0,bottom:0,left:0},before:function(a){},success:function(a){},error:function(a){}},a.position=g({},this.options.position,a.position),a.diy=g({},this.options.diy,a.diy),g(this.options,a),this.start()}return f(b,[{key:"start",value:function(){this._timer=!0,this._start()}},{key:"_start",value:function(){var b=this,c=this.options;clearTimeout(this._timer),this._timer&&(this._timer=setTimeout(function(){var d=Array.prototype.slice.apply(c.el.querySelectorAll("[data-src]"));if(!d.length&&c.done)return clearTimeout(b._timer);d.forEach(function(d){!d.dataset.LazyLoadImgState&&a(d,c.position)&&b.loadImg(d)}),b._start()},c.time))}},{key:"loadImg",value:function(a){var b=this,c=this.options;a.dataset.LazyLoadImgState="start",c.before.call(this,a);var e=new h.Image;e.src=a.dataset.src,e.addEventListener("load",function(){return"diy"===c.mode?(a.src=d(a.src,a.width,a.height),c.diy.backgroundImage="url("+e.src+")",g(a.style,c.diy)):a.src=e.src,delete a.dataset.src,delete a.dataset.LazyLoadImgState,c.success.call(b,a)},!1),e.addEventListener("error",function(){delete a.dataset.src,delete a.dataset.LazyLoadImgState,c.error.call(b,a)},!1)}},{key:"destroy",value:function(){delete this._timer}}]),b}()});