const AdUi=function(controller){this.controller=controller;this.adContainerDiv=document.createElement('div');this.controlsDiv=document.createElement('div');this.countdownDiv=document.createElement('div');this.seekBarDiv=document.createElement('div');this.progressDiv=document.createElement('div');this.playPauseDiv=document.createElement('div');this.muteDiv=document.createElement('div');this.sliderDiv=document.createElement('div');this.sliderLevelDiv=document.createElement('div');this.fullscreenDiv=document.createElement('div');this.boundOnMouseUp=this.onMouseUp.bind(this);this.boundOnMouseMove=this.onMouseMove.bind(this);this.adPlayheadTracker={'currentTime':0,'duration':0,'isPod':false,'adPosition':0,'totalAds':0,};this.controlPrefix=this.controller.getPlayerId()+'_';this.showCountdown=true;if(this.controller.getSettings().showCountdown===false){this.showCountdown=false;}
this.createAdContainer();};AdUi.prototype.createAdContainer=function(){this.assignControlAttributes(this.adContainerDiv,'ima-ad-container');this.adContainerDiv.style.position='absolute';this.adContainerDiv.style.zIndex=1111;this.adContainerDiv.addEventListener('mouseenter',this.showAdControls.bind(this),false);this.adContainerDiv.addEventListener('mouseleave',this.hideAdControls.bind(this),false);this.createControls();this.controller.injectAdContainerDiv(this.adContainerDiv);};AdUi.prototype.createControls=function(){this.assignControlAttributes(this.controlsDiv,'ima-controls-div');this.controlsDiv.style.width='100%';this.assignControlAttributes(this.countdownDiv,'ima-countdown-div');this.countdownDiv.innerHTML=this.controller.getSettings().adLabel;this.countdownDiv.style.display=this.showCountdown?'block':'none';this.assignControlAttributes(this.seekBarDiv,'ima-seek-bar-div');this.seekBarDiv.style.width='100%';this.assignControlAttributes(this.progressDiv,'ima-progress-div');this.assignControlAttributes(this.playPauseDiv,'ima-play-pause-div');this.addClass(this.playPauseDiv,'ima-playing');this.playPauseDiv.addEventListener('click',this.onAdPlayPauseClick.bind(this),false);this.assignControlAttributes(this.muteDiv,'ima-mute-div');this.addClass(this.muteDiv,'ima-non-muted');this.muteDiv.addEventListener('click',this.onAdMuteClick.bind(this),false);this.assignControlAttributes(this.sliderDiv,'ima-slider-div');this.sliderDiv.addEventListener('mousedown',this.onAdVolumeSliderMouseDown.bind(this),false);if(this.controller.getIsIos()){this.sliderDiv.style.display='none';}
this.assignControlAttributes(this.sliderLevelDiv,'ima-slider-level-div');this.assignControlAttributes(this.fullscreenDiv,'ima-fullscreen-div');this.addClass(this.fullscreenDiv,'ima-non-fullscreen');this.fullscreenDiv.addEventListener('click',this.onAdFullscreenClick.bind(this),false);this.adContainerDiv.appendChild(this.controlsDiv);this.controlsDiv.appendChild(this.countdownDiv);this.controlsDiv.appendChild(this.seekBarDiv);this.controlsDiv.appendChild(this.playPauseDiv);this.controlsDiv.appendChild(this.muteDiv);this.controlsDiv.appendChild(this.sliderDiv);this.controlsDiv.appendChild(this.fullscreenDiv);this.seekBarDiv.appendChild(this.progressDiv);this.sliderDiv.appendChild(this.sliderLevelDiv);};AdUi.prototype.onAdPlayPauseClick=function(){this.controller.onAdPlayPauseClick();};AdUi.prototype.onAdMuteClick=function(){this.controller.onAdMuteClick();};AdUi.prototype.onAdFullscreenClick=function(){this.controller.toggleFullscreen();};AdUi.prototype.onAdsPaused=function(){this.addClass(this.playPauseDiv,'ima-paused');this.removeClass(this.playPauseDiv,'ima-playing');this.showAdControls();};AdUi.prototype.onAdsResumed=function(){this.onAdsPlaying();this.showAdControls();};AdUi.prototype.onAdsPlaying=function(){this.addClass(this.playPauseDiv,'ima-playing');this.removeClass(this.playPauseDiv,'ima-paused');};AdUi.prototype.updateAdUi=function(currentTime,remainingTime,duration,adPosition,totalAds){const remainingMinutes=Math.floor(remainingTime/60);let remainingSeconds=Math.floor(remainingTime%60);if(remainingSeconds.toString().length<2){remainingSeconds='0'+remainingSeconds;}
let podCount=': ';if(totalAds>1){podCount=' ('+adPosition+' '+
this.controller.getSettings().adLabelNofN+' '+totalAds+'): ';}
this.countdownDiv.innerHTML=this.controller.getSettings().adLabel+podCount+
remainingMinutes+':'+remainingSeconds;const playProgressRatio=currentTime/duration;const playProgressPercent=playProgressRatio*100;this.progressDiv.style.width=playProgressPercent+'%';};AdUi.prototype.unmute=function(){this.addClass(this.muteDiv,'ima-non-muted');this.removeClass(this.muteDiv,'ima-muted');this.sliderLevelDiv.style.width=this.controller.getPlayerVolume()*100+'%';};AdUi.prototype.mute=function(){this.addClass(this.muteDiv,'ima-muted');this.removeClass(this.muteDiv,'ima-non-muted');this.sliderLevelDiv.style.width='0%';};AdUi.prototype.onAdVolumeSliderMouseDown=function(){document.addEventListener('mouseup',this.boundOnMouseUp,false);document.addEventListener('mousemove',this.boundOnMouseMove,false);};AdUi.prototype.onMouseMove=function(event){this.changeVolume(event);};AdUi.prototype.onMouseUp=function(event){this.changeVolume(event);document.removeEventListener('mouseup',this.boundOnMouseUp);document.removeEventListener('mousemove',this.boundOnMouseMove);};AdUi.prototype.changeVolume=function(event){let percent=(event.clientX-this.sliderDiv.getBoundingClientRect().left)/this.sliderDiv.offsetWidth;percent*=100;percent=Math.min(Math.max(percent,0),100);this.sliderLevelDiv.style.width=percent+'%';if(this.percent==0){this.addClass(this.muteDiv,'ima-muted');this.removeClass(this.muteDiv,'ima-non-muted');}else{this.addClass(this.muteDiv,'ima-non-muted');this.removeClass(this.muteDiv,'ima-muted');}
this.controller.setVolume(percent/100);};AdUi.prototype.showAdContainer=function(){this.adContainerDiv.style.display='block';};AdUi.prototype.onAdError=function(){this.adContainerDiv.style.display='none';};AdUi.prototype.onAdBreakStart=function(adEvent){this.adContainerDiv.style.display='block';const contentType=adEvent.getAd().getContentType();if((contentType==='application/javascript')&&!this.controller.getSettings().showControlsForJSAds){this.controlsDiv.style.display='none';}else{this.controlsDiv.style.display='block';}
this.onAdsPlaying();this.hideAdControls();};AdUi.prototype.onAdBreakEnd=function(){const currentAd=this.controller.getCurrentAd();if(currentAd==null||currentAd.isLinear()){this.adContainerDiv.style.display='none';}
this.controlsDiv.style.display='none';this.countdownDiv.innerHTML='';};AdUi.prototype.onAllAdsCompleted=function(){this.adContainerDiv.style.display='none';};AdUi.prototype.onLinearAdStart=function(){this.removeClass(this.adContainerDiv,'bumpable-ima-ad-container');};AdUi.prototype.onNonLinearAdLoad=function(){this.adContainerDiv.style.display='block';this.addClass(this.adContainerDiv,'bumpable-ima-ad-container');};AdUi.prototype.onPlayerEnterFullscreen=function(){this.addClass(this.fullscreenDiv,'ima-fullscreen');this.removeClass(this.fullscreenDiv,'ima-non-fullscreen');};AdUi.prototype.onPlayerExitFullscreen=function(){this.addClass(this.fullscreenDiv,'ima-non-fullscreen');this.removeClass(this.fullscreenDiv,'ima-fullscreen');};AdUi.prototype.onPlayerVolumeChanged=function(volume){if(volume==0){this.addClass(this.muteDiv,'ima-muted');this.removeClass(this.muteDiv,'ima-non-muted');this.sliderLevelDiv.style.width='0%';}else{this.addClass(this.muteDiv,'ima-non-muted');this.removeClass(this.muteDiv,'ima-muted');this.sliderLevelDiv.style.width=volume*100+'%';}};AdUi.prototype.showAdControls=function(){this.addClass(this.controlsDiv,'ima-controls-div-showing');this.playPauseDiv.style.display='block';this.muteDiv.style.display='block';this.fullscreenDiv.style.display='block';if(!this.controller.getIsIos()){this.sliderDiv.style.display='block';}};AdUi.prototype.hideAdControls=function(){this.removeClass(this.controlsDiv,'ima-controls-div-showing');this.playPauseDiv.style.display='none';this.muteDiv.style.display='none';this.sliderDiv.style.display='none';this.fullscreenDiv.style.display='none';};AdUi.prototype.assignControlAttributes=function(element,controlName){element.id=this.controlPrefix+controlName;element.className=this.controlPrefix+controlName+' '+controlName;};AdUi.prototype.getClassRegexp=function(className){return new RegExp('(^|[^A-Za-z-])'+className+
'((?![A-Za-z-])|$)','gi');};AdUi.prototype.elementHasClass=function(element,className){const classRegexp=this.getClassRegexp(className);return classRegexp.test(element.className);};AdUi.prototype.addClass=function(element,classToAdd){element.className=element.className.trim()+' '+classToAdd;};AdUi.prototype.removeClass=function(element,classToRemove){const classRegexp=this.getClassRegexp(classToRemove);element.className=element.className.trim().replace(classRegexp,'');};AdUi.prototype.getAdContainerDiv=function(){return this.adContainerDiv;};AdUi.prototype.setShowCountdown=function(showCountdownIn){this.showCountdown=showCountdownIn;this.countdownDiv.style.display=this.showCountdown?'block':'none';};export default AdUi;